/*! CamCalc v0.0.2 | (c) 2013 Xiao Yu, @HypertextRanch | MIT license */
(function(){var t,e,a;e="undefined"!=typeof exports&&null!==exports?exports:this,t=e.CamCalc=null!=(a=e.CamCalc)?a:{}}).call(this),function(){CamCalc.ApertureSnap=function(){function t(t){this.steps=t.steps||1/3}var e,a,r;return t.prototype.updateSettings=function(t){return t.steps?this.steps=t.steps:void 0},t.prototype.calculate=function(t){var c,i;return c=e.call(this,t),i=r.call(this,c),{aperture:a.call(this,i)}},t.prototype.getStops=function(t,c){var i,n,o,s;for(o=r.call(this,e.call(this,t))-this.steps,n=r.call(this,e.call(this,c))+this.steps,s=[];n>=(o+=this.steps);)i=a.call(this,o),i>=t&&c>=i&&s.push(i);return s},e=function(t){return Math.log(Math.pow(t,2))/Math.LN2},a=function(t){var e;return e=Math.sqrt(Math.pow(2,t)),e>=22.6&&22.7>e?22:e>=10?Math.round(e):Math.round(10*e)/10},r=function(t){var e,a,r,c,i,n,o,s,h;for(c=Math.floor(t)-this.steps,r=Math.floor(t)+1,o=function(){var t;for(t=[];r>=(c+=this.steps);)t.push(c);return t}.call(this),i=0,n=1,s=0,h=o.length;h>s;s++)e=o[s],a=Math.abs(e-t),n>a&&(i=e,n=a);return i},t}()}.call(this),function(){CamCalc.DepthOfField=function(){function t(t){this.coc=(t.coc||29)/1e3,this.aperture=t.aperture||4,this.focalLength=t.focalLength||50,this.distance=1e3*(t.distance||3)}var e,a,r,c;return t.prototype.updateSettings=function(t){return t.coc&&(this.coc=t.coc/1e3),t.aperture&&(this.aperture=t.aperture),t.focalLength&&(this.focalLength=t.focalLength),t.distance?this.distance=1e3*t.distance:void 0},t.prototype.calculate=function(){var t,i,n;return n=a.call(this,this.coc,this.aperture),i=c.call(this,n,this.focalLength,this.distance),t=r.call(this,i,this.distance),{nearLimit:i/1e3,farLimit:t/1e3,depth:e.call(this,i,t)/1e3}},a=function(t,e){return e*Math.sqrt(562500*Math.pow(t,2)-Math.pow(e,2))/375},c=function(t,e,a){var r,c,i,n,o;return n=Math.pow(a-e,2)*Math.pow(t,2),o=Math.pow(e,2)*Math.pow(a,2),c=e*Math.sqrt(n+o),i=Math.pow(e,2)*a-Math.pow(e,2)*t,r=(a-2*e)*t+2*Math.pow(e,2),(c+i)/r},r=function(t,e){return e>=2*t?1/0:t*e/(2*t-e)},e=function(t,e){return isFinite(e)?e-t:1/0},t}()}.call(this),function(){CamCalc.IdealAperture=function(){function t(t){this.focalLength=t.focalLength||50,this.objectNear=1e3*(t.objectNear||4),this.objectFar=1e3*(t.objectFar||5),r.call(this)}var e,a,r;return t.prototype.updateSettings=function(t){return t.focalLength&&(this.focalLength=t.focalLength),t.objectNear&&(this.objectNear=1e3*t.objectNear),t.objectFar&&(this.objectFar=1e3*t.objectFar),r.call(this)},t.prototype.calculate=function(){return{aperture:e.call(this,this.objectNear,this.objectFar,this.focalLength),distance:a.call(this,this.objectNear,this.objectFar)/1e3}},e=function(t,e,a){return Math.sqrt(375*(t*a/(t-a)-e*a/(e-a)))},a=function(t,e){return 2*t*e/(t+e)},r=function(){var t;if(!(this.objectNear<=this.objectFar))return t=this.objectNear,this.objectNear=this.objectFar,this.objectFar=t},t}()}.call(this);